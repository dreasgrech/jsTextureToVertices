<html>

	<head>
	</head>

	<body>

		<div>
			<canvas id="imageCanvas" width="100" height="100" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
			<canvas id="polygonCanvas" width="100" height="100" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
		</div>
		<script src="t2v/mouse.js"></script>
		<script src="t2v/rectangle.js"></script>
		<script src="t2v/marker.js"></script>
		<script src="t2v/library.js"></script>
		<script>
			var imageFilename = "images/block.png";
			var imageCanvas = document.getElementById('imageCanvas'), 
			    polygonCanvas = document.getElementById('polygonCanvas');

			if (imageCanvas.getContext && polygonCanvas.getContext) {
				// Initaliase a 2-dimensional drawing context
				var imageContext = imageCanvas.getContext('2d'),
				    polygonContext = polygonCanvas.getContext('2d');
				//Canvas commands go here
				var maxVertices = 10;
				t2v(imageCanvas, imageContext, polygonCanvas, polygonContext, imageFilename, maxVertices, function (library) {
					polygonCanvas.addEventListener("click", function(e) {
						var position = {
							x: e.clientX - imageCanvas.offsetLeft,
							y: e.clientY - imageCanvas.offsetTop
						};
						library.addMarker(position);

					}, false);

					var mouseInput = mouse(polygonCanvas);
					mouseInput.move(function (pos) {
						library.update();
						if (library.getMarkerAt(pos)) {
							polygonCanvas.style.cursor = 'pointer';
						} else {
							polygonCanvas.style.cursor = 'default';
						}
					});
					mouseInput.drag(function (pos) {
						var marker = library.getMarkerAt(pos);
						if (marker) {
							library.moveMarker(marker, pos);
							//marker.moveTo(pos);
				       		}
					});
				});





			}
		</script>
	</body>

</html>
